<html>

<head>
<META NAME="Generator" CONTENT="EditPlus"> 
<META NAME="Author" CONTENT=""> 
<META NAME="Keywords" CONTENT=""> 
<META NAME="Description" CONTENT=""> 
<meta http-equiv="Expires" CONTENT="0"> 
<meta http-equiv="Cache-Control" CONTENT="no-cache"> 
<meta http-equiv="Pragma" CONTENT="no-cache"> 
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>设置打印参数</title>

<link rel="stylesheet" type="text/css" href="data/css/form.css"></link>
<script type="text/javascript"  src="data/js/hashtable.js"></script>
<script type="text/javascript"  src="data/js/formutil.js"></script>
<script type="text/javascript"  src="data/js/form_tree.js"></script>
<script type="text/javascript"  src="data/js/form.js"></script>
<script type="text/javascript"  src="data/js/appendtable.js"></script>
<script type="text/javascript"  src="data/js/form_print.js"></script>
<script type="text/javascript"  src="data/js/form_webtabs.js"></script>
<script type="text/javascript"  src="data/js/seal.js"></script>
<script type="text/javascript">
function sendTo()
{
  var obj = document.getElementById("whichtab");
  var k = window.dialogArguments;
  var radios = document.getElementsByName("radio");
  var value ="";
  for(var i=0;i<radios.length;i++){
  	if(radios[i].checked){
  		value = radios[i].value;
  		break;
  	}
  }
  if("special"==value){
  	  var s = document.getElementById("whichtab").value; 
  	  k.setPrintTab(s);
  }
  if("range"==value){
  	 var s = document.getElementById("whichrange").value;
  	 
  	 if(s=="" || s.indexOf(",")<1 && s.indexOf("-")<1){
  	 	alert("请按照指定格式输入有效的打印页面或范围。");
  	 	return;
  	 }
  	 
  	 var nums = s.split("-");
  	 var ids = k.getPageIDs();

  	 if(nums.length>1){
  	 	if(parseInt(nums[0])<1 || parseInt(nums[0])>ids.length){
  	 		alert("页面范围语法无效，超过页数范围。");
  	 		return;
  	 	}
  	 
  	 	if(nums[0].match(/\d$/)==null || nums[1].match(/\d$/)==null){
  	 		alert("页面范围语法无效，输入页数应为数字。");
  	 		return;
  	 	}
  	 	if(parseInt(nums[1])<=parseInt(nums[0])|| parseInt(nums[1])>ids.length){
  	 		alert("页面范围语法无效,结束页应该大于开始页。");
  	 		return;
  	 	}
  	 }
  	 nums = s.split(",");
  	 if(nums.length>1){
  	 	for(var i=0;i<nums.length;i++){
  	 		if(parseInt(nums[i])<1 || parseInt(nums[i])>ids.length){
  	 			alert("页面范围语法无效，超过页数范围。");
  	 			return;
  	 		}
  	 		if(nums[i].match(/\d$/)==null){
  	 			alert("页面范围语法无效i，输入页数应为数字。");
  	 			return;
  	 		}
  	 	}
  	 }
  	 k.setPrintTab(s);
  }

	var orientation = 1;
	radios = document.getElementsByName("orientation");
  for(var i=0;i<radios.length;i++){
  	if(radios[i].checked){
  		orientation = radios[i].value;
  		break;
  	}
  }
  
  k.setOrientation(orientation);
  
  window.returnValue = value; 
  window.close();

}
function cancelButton(){
	window.returnValue = false;
	window.close();
}
function initialSelects(){
	var obj = document.getElementById("whichtab");
	
	var k = window.dialogArguments;
	if(k!=null){
		var ids = k.getPageIDs();
		var names = k.getPageNames();
		for(var i=0;i<ids.length;i++){
			obj.options.add(new Option(names[i],ids[i]));
		}	
	}
}
</script> 
<style>
<!--
.title { 
   font-family : Arial,Vernada,Tahoma, sans-serif;
   font-size: 14px;
   font-style: bold;
   color : #000000;
   background-color : White; text-decoration:none
}
.normal{
	font-family : Arial,Vernada, Tahoma, Helvetica, sans-serif;
	font-size: 12px;
	color: #444444;
	text-decoration: none;
	line-height: 21px;
        
}
-->
</style>

</head>
<body onload="initialSelects()">
<table cellspacing="2" cellpadding="2" style="position:absolute;top:10;left:10;">
	<tr>
		<td class="title" colspan="2">设置打印参数</td>
	</tr>
	<tr>
		<td class="normal" colspan="2"><input type="radio" name="radio" value="all" checked>全部</td>
	</tr>
	<tr>
		<td class="normal" ><input type="radio" name="radio" value="special">指定页面：</td>
		<td class="normal" ><select size="1" id="whichtab" style="width:200"></select></td>
	</tr>
	<tr>
		<td class="normal" ><input type="radio" name="radio" value="range">页面范围：</td>
		<td class="normal" ><input type="text" id="whichrange" style="width:200;"></input></td>
	</tr>
	<tr>
		<td class="normal" colspan="2">（输入页码或页面范围。如，5-12 或 2,4）</td>
	</tr>
	<tr>
		<td class="normal" >打印方向：</td>
		<td class="normal" >			
			<input type="radio" name="orientation" value=1 checked>纵向
			<input type="radio" name="orientation" value=2>横向
		</td>
	</tr>		
	<tr>
		<td align="right" colspan="2">
			<table>
			<tr>
			<td><input type="button" value="确定" onclick="sendTo()"></input></td>
			<td><input type="button" value="取消" onclick="cancelButton()"></td>
			</tr>
			</table>
		</td>
	</tr>

</table>

</body>

</html>