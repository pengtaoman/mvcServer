<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title> New Document </title>
<script language="JavaScript">
<!--

function GetPopupCssText(){

    var styles = document.styleSheets;
    var csstext = "";
    for(i=0; i<styles.length; i++)
    {
        if (styles[i].id == "popupmanager")
            csstext += styles[i].cssText;
    }
    return csstext;

}


var oPopup = window.createPopup();
var oPopupDocument = oPopup.document ;
var oPopupBody  = oPopupDocument.body ;
var oPopupStyle = oPopupDocument.createStyleSheet("style/crm/popupMenu.css") ;


function hidePop(){
    if (oPopup) oPopup.hide();
}

function showPop(aObj){
	oPopupBody.innerHTML = document.getElementById('popbody').innerHTML;
	
	var left=window.screenLeft+fetch_object_posleft(aObj);
	var ctop=window.screenTop+fetch_object_postop(aObj)+aObj.offsetHeight;
    oPopup.show(left,ctop,100, 100); 
}


function showPop2(objButton){
    
	var objBody = document.getElementById('popbody');

	oPopupBody.innerHTML=objBody.outerHTML;

    var toastWidth = objBody.offsetWidth;
    var toastHeight = objBody.offsetHeight;

    var toastVerticalMargin = 28;
    var toastHorizontalMargin = 16;

    var screenWidth = window.screen.width;
    var screenHeight = window.screen.height;
	
    oPopup.show(screenWidth - toastWidth - toastHorizontalMargin, 
				screenHeight - toastHeight - toastVerticalMargin,
                toastWidth, toastHeight);

}


function fetch_object_posleft(elm){
	var left = elm.offsetLeft;
	while((elm = elm.offsetParent) != null)	{
		left += elm.offsetLeft;
	}
	return left;
}

function fetch_object_postop(elm){
	var top = elm.offsetTop;
	while((elm = elm.offsetParent) != null)	{
		top += elm.offsetTop;
	}
	return top;
}


oPopupBody.onclick = hidePop;


//-->
</script>
</head>

<body>
<button onclick="showPop(this)">test</button>
<div style="display: none" id="popbody" >
			<table  cellspacing="0" cellpadding="0" border="0" width="100%" onclick="return false;">
			  <tr>
					<td  valign="top" style="padding:5px; line-height:16px " class="popupBodyText">
						  <a href="#" target="_self" onclick="alert(123)">最近5次访问过的页面</a><br>
						  <a href="#" target="_self">最近5次访问过的页面</a><br>
						  <a href="#" target="_self">最近5次访问过的页面</a><br>
						  <a href="#" target="_self">最近5次访问过的页面</a><br>
						  <a href="#" target="_self">最近5次访问过的页面</a>
					</td>
			  </tr>
			</table>
</div>
</body>
</html>
